{"version":3,"file":"index.js","sources":["../src/js/consts.js","../src/js/tools.js","../src/js/render-functions.js","../src/js/pixabay-api.js","../src/js/handler.button.js","../src/js/handler.submit.js","../src/main.js"],"sourcesContent":["export const API_KEY = '49335646-80c9a1e6c5c5033cc7f2a4c93',\n  baseUrl = 'https://pixabay.com/api/',\n  pagination = { page: 1, per_page: 15 },\n  eventDomType = {\n    search: 'submit',\n    loadMore: 'button',\n  },\n  refs = {\n    container: document.querySelector('section.container'),\n    loader: document.querySelector('div.loader'),\n    gallery: document.querySelector('ul.gallery'),\n    loadMoreBtn: document.querySelector('.load-more-btn'),\n  };\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { showLoadMoreBtn, showLoader } from './render-functions';\n\nconst conf = {\n  position: 'topRight',\n  timeout: 3000,\n};\n\nconst Err = (typeError, emessage = 'empty message') => {\n  if (typeError === 'error') {\n    showLoadMoreBtn(false);\n    showLoader(false);\n    iziToast.error({\n      message: emessage,\n      ...conf,\n    });\n  } else if (typeError === 'success') {\n    iziToast.success({\n      message: emessage,\n      ...conf,\n    });\n  }\n};\n\nexport { Err };\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { refs } from './consts';\nimport { Err } from './tools';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt', // Use the alt attribute of images for captions\n  captionDelay: 250, // Delay in milliseconds before showing the caption\n});\n\nconst render = data => {\n  if (data && data.total > 0) {\n    showLoader(false); // loader\n    const markup = data.hits\n      .map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) => `\n          <li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n              <img\n                class=\"gallery-image\"\n                src=\"${webformatURL}\"\n                alt=\"${tags}\"\n                width=\"350\" \n                height=\"290\"\n            />\n            </a>\n            <ul class=\"gallery-info\">\n              <li class=\"gallery-info-item\">\n                <p>Downloads</p>\n                <p>${downloads}</p>\n              </li>\n              <li class=\"gallery-info-item\">\n                <p>Comments</p>\n                <p>${comments}</p>\n              </li>\n              <li class=\"gallery-info-item\">\n                <p>Views</p>\n                <p>${views}</p>\n              </li>\n              <li class=\"gallery-info-item\">\n                <p>Likes</p>\n                <p>${likes}</p>\n              </li>\n            </ul>\n          </li>\n          `\n      )\n      .join('');\n    refs.gallery.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh(); // refresh images\n  } else {\n    Err(\n      'success',\n      'Sorry, there are no images matching your search query. Please try again!'\n    );\n  }\n};\n\nconst showLoader = (flag = true) => {\n  const el = refs.loader;\n  if (flag) {\n    if (el.hasAttribute('style')) {\n      el.removeAttribute('style');\n    }\n  } else {\n    if (!el.hasAttribute('style')) {\n      el.setAttribute('style', 'display:none');\n    }\n  }\n};\n\nconst showLoadMoreBtn = (flag = true) => {\n  const el = refs.loadMoreBtn;\n  if (flag) {\n    if (el.hasAttribute('style')) {\n      el.removeAttribute('style');\n    }\n  } else {\n    if (!el.hasAttribute('style')) {\n      el.setAttribute('style', 'display:none');\n    }\n  }\n};\nexport { render, showLoader, showLoadMoreBtn };\n","import { API_KEY, baseUrl, pagination } from './consts';\nimport axios from 'axios';\n\nconst getData = async search => {\n  search = search ? search : '';\n  const opt = {\n    key: API_KEY,\n    q: search,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: pagination.page,\n    per_page: pagination.per_page,\n  };\n  return await axios.get(baseUrl + '?' + new URLSearchParams(opt));\n};\n\nexport default getData;\n","import { Err } from './tools';\nimport getData from './pixabay-api';\nimport { render, showLoader, showLoadMoreBtn } from './render-functions';\nimport { pagination, refs } from './consts';\n\n// Load More Btn\nconst handleClickBtn = event => {\n  showLoader(true); // show loader\n  const search = localStorage.getItem('q-data');\n  const main = refs.loader;\n  getData(search)\n    .then(res => {\n      const total = Math.ceil(res.data.totalHits / pagination.per_page);\n      if (res.status != 200) {\n        return Err('error', 'Server response fail'); // check\n      }\n      if (pagination.page > total) {\n        pagination.page = 1;\n        return Err('error', \"We're sorry, there are no more posts to load\"); // load posts\n      }\n      main.innerHtml = render(res.data); // render\n      pagination.page += 1; // fix\n    })\n    .catch(e => {\n      return Err('error', e.message);\n    });\n};\n\nexport { handleClickBtn };\n","import { Err } from './tools';\nimport getData from './pixabay-api';\nimport { render, showLoader, showLoadMoreBtn } from './render-functions';\nimport { refs, pagination } from './consts';\n\n// grab data from event\nconst grabDataFrom = event => {\n  const formData = new FormData(event.target.form); // submit\n  // when we change search target - car (has more then 1 page), ssd (has only one )\n  const oldValue = localStorage.getItem('q-data');\n  const newValue = formData.get('search');\n  if (oldValue && oldValue !== newValue) {\n    pagination.page = 1;\n  }\n  localStorage.setItem('q-data', newValue); // store query str\n  return Object.fromEntries(formData);\n};\n\n// Search handler Btn\nconst handleSubmitBtn = event => {\n  showLoadMoreBtn(false); // hide load more btn\n  event.preventDefault();\n  const formProps = grabDataFrom(event);\n  if (!formProps.search) {\n    return Err(\n      'error',\n      'Sorry, there are no images matching your search query. Please try again!'\n    ); // disable empty search\n  } else {\n    showLoader(true);\n  }\n  refs.gallery.innerHTML = ''; // clear content\n  const main = refs.loader;\n  pagination.page = 1; // all search query began from 1!\n  getData(formProps.search)\n    .then(res => {\n      const total = Math.ceil(res.data.totalHits / pagination.per_page);\n      if (res.status != 200) {\n        return Err('error', 'Server response fail');\n      } // <- ( code above ) check response from api\n      if (pagination.page > total) {\n        pagination.page = 1;\n        return Err('error', \"We're sorry, there are no more posts to load\");\n      } // check end connection\n      main.innerHtml = render(res.data); // render\n      setTimeout(() => showLoadMoreBtn(true), 1000); // show load more btn)\n      pagination.page += 1; // next images group\n    })\n    .catch(e => {\n      return Err('error', e.message);\n    });\n};\n\nexport { handleSubmitBtn };\n","import { showLoader, showLoadMoreBtn } from './js/render-functions';\nimport { refs, eventDomType } from './js/consts';\nimport { handleClickBtn } from './js/handler.button';\nimport { handleSubmitBtn } from './js/handler.submit';\n\nshowLoader(false); // remove loader\nshowLoadMoreBtn(false); // remove load more btn\n\n// Listeners\nrefs.container.addEventListener('click', event => {\n  if (event.target.type === eventDomType.search) {\n    handleSubmitBtn(event);\n  } else if (event.target.type === eventDomType.loadMore) {\n    handleClickBtn(event);\n  } else {\n  }\n});\n"],"names":["API_KEY","baseUrl","pagination","eventDomType","refs","conf","Err","typeError","emessage","showLoadMoreBtn","showLoader","iziToast","lightbox","SimpleLightbox","render","data","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","flag","el","getData","search","opt","axios","handleClickBtn","event","main","res","total","e","grabDataFrom","formData","oldValue","newValue","handleSubmitBtn","formProps"],"mappings":"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"}